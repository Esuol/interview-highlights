## es678

### 介绍下 Set、Map、WeakSet 和 WeakMap 的区别？

#### Set
1.成员不能重复

2.只有健值，没有健名，有点类似数组。

3. 可以遍历，方法有add, delete,has

#### weakSet

成员都是对象

成员都是弱引用，随时可以消失。 可以用来保存DOM节点，不容易造成内存泄漏

不能遍历，方法有add, delete,has

#### Map

本质上是健值对的集合，类似集合

可以遍历，方法很多，可以干跟各种数据格式转换

#### weakMap

1.直接受对象作为健名（null除外），不接受其他类型的值作为健名

健名所指向的对象，不计入垃圾回收机制

不能遍历，方法同get,set,has,delete

#### es5 实现const

```js
var __const = function __const (data, value) {
  window.data = value // 把要定义的data挂载到window下，并赋值value
  Object.defineProperty(window, data, { // 利用Object.defineProperty的能力劫持当前对象，并修改其属性描述符
    enumerable: false,
    configurable: false,
    get: function () {
      return value
    },
    set: function (data) {
      if (data !== value) { // 当要对当前属性进行赋值时，则抛出错误！
        throw new TypeError('Assignment to constant variable.')
      } else {
        return value
      }
    }
  })
}
__const('a', 10)
console.log(a)
delete a
console.log(a)
for (let item in window) { // 因为const定义的属性在global下也是不存在的，所以用到了enumerable: false来模拟这一功能
  if (item === 'a') { // 因为不可枚举，所以不执行
    console.log(window[item])
  }
}
a = 20 // 报错
```

#### 闭包

闭包的定义其实很简单：函数 A 内部有一个函数 B，函数 B 可以访问到函数 A 中的变量，那么函数 B 就是闭包。

```js
function A(){
  let a=1;
  window.B=function(){
      console.log(a)
  }
}
A();
B();//1
```

很多人对于闭包的解释可能是函数嵌套了函数，然后返回一个函数。其实这个解释是不完整的，就比如我上面这个例子就可以反驳这个观点。

在 JS 中，闭包存在的意义就是让我们可以间接访问函数内部的变量。